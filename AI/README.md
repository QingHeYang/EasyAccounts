# AI+ 功能

## 简介
EasyAccounts 内置了一个AI智能助手。  
这个小助手叫"小易"，是个精打细算的小财迷，会用有趣的方式跟你互动。

### 配置文件说明

#### task.prompt - 任务指导文件
告诉AI你的特殊情况，让它更懂你。

直接在 `## 特殊指导` 下方写你的家庭信息就行：
- 家庭成员名字（孩子叫啥、养了什么宠物）
- 平时的记账习惯
- 经常买什么东西

#### 小易.role - AI性格设定
这个文件决定了小易的性格，每个字段的意思：

```yaml
role: 一个家庭小财务官              # AI扮演什么角色
cos_role: 无                      # 角色形象（一般不用改）
name: 小易                        # AI叫什么名字
character: 活泼灵动，古灵精怪...    # AI的性格，改这个可以调整说话风格
user_role: 家庭主人                # 你是什么角色
user_role_description: ...        # 对你角色的描述
user_scene: 温馨的家               # 场景设定
location:                         # 地理位置（可以不填）
```

### 使用方法
1. 直接改上面两个文件，写入你的信息
2. **改完后需要重启AI服务才会生效**
3. 重启命令：`docker restart easy_accounts_ai`（如果你用的是AI功能的话）

### 注意事项
- 别写敏感信息进去（银行卡号、密码这些）
- 想恢复默认就把改的内容删了就行

---
（上述内容由AI生成，下面是开发者手写的）  
## AI功能  
### 开发背景  
2.5.0版本更新了这个ai相关的功能  
不是我追时髦，其实我本职工作也是干这个差不多的东西  
我拿我在公司的成果的的一个中间版本，改了改，完成的这个AI+的功能  

### 功能  

该智能体内置了8个工具，可以直接操作你的账本数据：

#### 1. accounts - 账户查询
查询你有多少资金账户，返回账户名称、ID和余额。  
比如你问"我微信还有多少钱"，AI会调这个工具。

#### 2. types - 分类查询  
获取所有的账单分类（标签）信息，包含分类ID、名称、父子关系。  
当你问"我都有哪些支出分类"时会用到。

#### 3. current_date - 获取时间
获取当前服务器时间，返回yyyy-MM-dd格式。  
处理"这个月"、"上个季度"这种时间相关问题时会用。

#### 4. year_statistics - 年度统计
查询某年每个月的收入支出盈余数据。  
比如你问"2024年哪个月花钱最多"，就会调用这个。

#### 5. flows - 流水查询（最强大的工具）
根据各种条件查询流水记录，支持：
- 按账户查询（某个微信/支付宝的流水）
- 按时间查询（上个月、某个时间段）
- 按分类查询（所有餐饮支出）
- 按备注关键字查询（"社保"、"工资"等）
- 组合查询（这个月微信的餐饮支出）

返回具体流水列表和收支汇总。

#### 6. add_flow - 记账
添加一条流水记录，可以记录：
- 收入（工资到账、红包等）
- 支出（买东西、交房租等）
- 内部转账（微信转支付宝等）

比如你说"记一笔，今天吃饭花了50块"，AI就会帮你记上。

#### 7. update_flow - 修改流水
更新已有的流水记录。  
当你发现记错了，可以说"把昨天那笔吃饭改成60块"。

#### 8. make_excel - 生成报表
根据查询条件生成Excel文件，参数和flows一样，只是输出变成Excel。  
比如"导出这个月的所有支出"，就会生成一个Excel文件。

### 使用示例

你可以这样问小易：
- "我微信还有多少钱？"
- "这个月吃饭花了多少？"
- "上个月收入多少？"
- "什么时候给孩子交的学费？"
- "记一笔，今天加油200"
- "导出今年所有的支出明细"

小易会自动调用相应的工具，帮你查询或记录。

### 技术细节
这些工具基于Tool call实现，AI会根据你的问题自动选择合适的工具组合。  
比如你问"这个月微信的餐饮支出"，AI会：
1. 先调用current_date获取当前日期
2. 再调用accounts获取微信账户ID
3. 然后调用types获取餐饮分类ID
4. 最后调用flows查询具体流水

整个过程自动完成，你只需要正常对话就行。  

## 开源  
目前代码开源到2.4.0版本  
ai相关的2.5.0版本，可能要等很久之后了  

原本源码会落后正式版本2-3个小版本的
我这个人本来就懒散，整理代码然后开源，写文档，太耗时间了  

不过如果开发者们愿意开发  
我给的建议是，进入到ai的容器内部  
将想修改的文件映射出来，然后修改  
不建议改动，项目我写的比较垃圾，外加有大量ai生成的代码  
很容易变屎山  
哪天我更新了，可能会和你写的代码冲突  






